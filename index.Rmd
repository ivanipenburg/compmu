---
title:  'Computational Musicology'
author: 'Ilja van Ipenburg'
date:   'February--March 2020'
output: 
    flexdashboard::flex_dashboard:
        storyboard: true
        theme: flatly
---

```{r setup}
# In order to use these packages, we need to install flexdashboard, plotly, and Cairo.
library(tidyverse)
library(plotly)
library(spotifyr)
source('spotify.R')

joran2016 <- get_playlist_audio_features("spotify", "37i9dQZF1CyJsMsSzzPflw")
joran2017 <- get_playlist_audio_features("spotify", "37i9dQZF1E9TOYaUQk6QFJ")
joran2018 <- get_playlist_audio_features("spotify", "37i9dQZF1EjkhTcRUoUqV5")
joran2019 <- get_playlist_audio_features("spotify", "37i9dQZF1Et8uLwNBVrvuH")
  
ilja2016 <- get_playlist_audio_features("spotify", "37i9dQZF1Cz2hsgWnHLGyO")
ilja2017 <- get_playlist_audio_features("spotify", "37i9dQZF1E9NzC698hTPFX")
ilja2018 <- get_playlist_audio_features("spotify", "37i9dQZF1EjtD9Bk3XI1ge")
ilja2019 <- get_playlist_audio_features("spotify", "37i9dQZF1Etj3WX3nXZqyP")

joran <- 
  joran2016 %>% mutate(year="2016") %>%
  bind_rows(joran2017 %>% mutate(year="2017") %>%
  bind_rows(joran2018 %>% mutate(year="2018") %>%
  bind_rows(joran2019 %>% mutate(year="2019"))))

ilja <- 
  ilja2016 %>% mutate(year="2016") %>%
  bind_rows(ilja2017 %>% mutate(year="2017") %>%
  bind_rows(ilja2018 %>% mutate(year="2018") %>%
  bind_rows(ilja2019 %>% mutate(year="2019"))))

data <- 
  joran %>% mutate(person="Joran") %>%
  bind_rows(ilja %>% mutate(person="Ilja"))

mean_joran <- joran %>%
  group_by(year) %>%
  summarise(mean_energy = mean(energy), SD_energy = sd(energy), mean_danceability = mean(danceability), SD_danceability = sd(danceability), mean_valence = mean(valence), SD_valence = sd(valence), mean_acousticness = mean(acousticness), mean_instrumentalness = mean(instrumentalness))
mean_ilja <- ilja %>%
  group_by(year) %>%
  summarise(mean_energy = mean(energy), SD_energy = sd(energy), mean_danceability = mean(danceability), SD_danceability = sd(danceability), mean_valence = mean(valence), SD_valence = sd(valence), mean_acousticness = mean(acousticness), mean_instrumentalness = mean(instrumentalness))


mean <-
  mean_joran %>% mutate(owner="Joran") %>%
  bind_rows(mean_ilja %>% mutate(owner="Ilja"))
```



### Introduction: Brothers leaving the nest, but staying close together
```{r}

ggplot(mean, aes(x = year, linetype = owner, group = owner)) +
  geom_line(aes(y = mean_energy, color="Danceability", alpha=0.9), size = 2) +
  geom_line(aes(y = mean_danceability, color="Energy", alpha=0.9), size = 2) +
  geom_line(aes(y = mean_valence, color="Valence", alpha=0.9), size = 2) +
  geom_line(aes(y = mean_acousticness, color="Acousticness", alpha=0.9), size = 2) +
  geom_line(aes(y = mean_instrumentalness, color="Instrumentalness", alpha=0.9), size = 2) +
  labs(x="Year", y="Mean", colour="Colour", type="Person", title="Feature means over the years") +
  guides(alpha="none")
```

***

In this portfolio I will be comparing the music taste of my brother Joran and I (Ilja) over the years. To do this, I will be using Spotify's "Your Top Songs 20XX" playlist from both my brother and I for 2016 until 2019. Both of us have been using spotify as our main music app for these years, so your top songs playlists should reflect our music taste over the years pretty closely.

The research question I will be trying to answer is how me and my brothers music taste have changed over the years and if our music tastes have grown closer to eachother or further apart over the past few years. This is an interesting question, as we lived together with my parents in 2016 and most of 2017, but in November 2017 I moved to Diemen and in January of 2018 my brother moved away to Rotterdam. I'm curious as to how this may have affected our music tastes, because when we both lived at my parents we were exposed to each others music regularly, but now it is not a regular occurance anymore.

As a first look at the change in your music over the years, I plotted the means of five Spotify features over these past four years. To give a better understanding of the plot, I will tell you about our general taste in music over the years. In 2016, I listened to what I would describe as mostly indierock, (indie)pop and electronic music, with a little bit of metal and hip-hop sprinkled in. For my brother, his taste was mostly metal, alternative rock and also electonic music. After this, my music taste shifted to a lot more hip-hop and less pop, while my brother started listening to more electronic music. In the last two years, I also started listening to more electronic music while also continuing my trend of hip-hop. My brother kept up with the electronic music, but also started listening to some less agressive rock. I think these changes are also reflected in the data. My danceability and energy seem to have generally gone upwards over the last few years, which is probably mostly due to more electronic music and milder hip-hop. For my brother, these have seemed to stay pretty much the same. With morer electronic music, you would expect the instrumentalness to go up like it did for my brother, but I think it didn't because I listen to slightly different electronic music than my brother. We both listen to a lot of drum&bass, but I listen to drum&bass with more vocals and melody while he listens to some rougher stuff.

In general, I think the plotted lines show we grew apart a bit after we both left the house, but have come closer together in the last year.

### The happiness of our music switched places.

```{r}
ggplot(data, aes(x=danceability, y=valence, color=person, size=energy)) +
  geom_point(alpha=0.5) +
  facet_wrap(~ year) +
  guides(fill = FALSE) +
  labs(x="Danceability", y="Valence", colour="Person", size="Energy", title="Valence and danceability over the years")

```

***

This plot is showing the data of all the songs over the years. Something that is immediately clear is that the valence for me (which is the red cloud) has seem to floated to the top of the blue sea a little bit. This could also be seen in the line chart in the last storyboard, but I think this plot shows it more clearly. While my brothers music had a higher valence in the first two years, mine suddenly started rising in 2018, while the valence of my brother lowered a little bit. You could think that I have gotten happier over the years, which I don't think is the case, but maybe sometimes you need happier music to cheer you up.

### Week 9: Chromagrams/cepstrograms and stuff

Sadly I had a busy week and couldn't get the compmus library to work when I got to that part on sunday. I would however appreciate it if you could give some feedback on the rest, as I've changed my research question this week as my last one wasn't that interesting.